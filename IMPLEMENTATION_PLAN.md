# ParadisePOS - План реалізації

## Огляд архітектури

```
┌─────────────────────────────────────────────────────────────────┐
│                         ParadisePOS                             │
├─────────────────────────────────────────────────────────────────┤
│  POS Terminal ←→ Products ←→ Recipes ←→ Ingredients ←→ Stock   │
│       ↓              ↓           ↓            ↓           ↓     │
│   Orders ───→ Transactions ───→ Inventory Updates ───→ Alerts  │
│       ↓                                                   ↓     │
│   Reports ←────────────────────────────────────── Notifications │
└─────────────────────────────────────────────────────────────────┘
```

---

## Фаза 1: Дані продуктів та інгредієнтів

### 1.1 Інгредієнти (Production Data)

| ID | Назва | Категорія | Одиниця | Залишок | Мін. запас | Ціна/од | Постачальник |
|----|-------|-----------|---------|---------|------------|---------|--------------|
| 1 | Молоко 2.5% | Молочні | ml | 10000 | 3000 | 0.032 | Молочар |
| 2 | Вершки 33% | Молочні | ml | 2000 | 1000 | 0.12 | Молочар |
| 3 | Молоко вівсяне | Молочні | ml | 2000 | 1000 | 0.08 | Alpro |
| 4 | Кава Арабіка | Кава | g | 5000 | 2000 | 0.85 | CoffeePro |
| 5 | Кава декаф | Кава | g | 1000 | 500 | 0.95 | CoffeePro |
| 6 | Чай чорний | Чай | g | 500 | 200 | 0.45 | TeaTime |
| 7 | Чай зелений | Чай | g | 400 | 200 | 0.55 | TeaTime |
| 8 | Матча | Чай | g | 200 | 100 | 2.50 | TeaTime |
| 9 | Сироп ваніль | Сиропи | ml | 750 | 300 | 0.08 | Monin |
| 10 | Сироп карамель | Сиропи | ml | 750 | 300 | 0.08 | Monin |
| 11 | Сироп лісовий горіх | Сиропи | ml | 500 | 300 | 0.08 | Monin |
| 12 | Шоколад темний | Топінги | g | 500 | 200 | 0.15 | Callebaut |
| 13 | Збита вершки | Топінги | ml | 500 | 200 | 0.10 | — |
| 14 | Цукор | Інше | g | 5000 | 2000 | 0.02 | — |
| 15 | Стакан 250мл | Упаковка | pcs | 200 | 100 | 2.50 | Пакувальник |
| 16 | Стакан 350мл | Упаковка | pcs | 200 | 100 | 3.00 | Пакувальник |
| 17 | Стакан 450мл | Упаковка | pcs | 150 | 100 | 3.50 | Пакувальник |
| 18 | Кришка | Упаковка | pcs | 500 | 200 | 0.80 | Пакувальник |

### 1.2 Готова продукція (Simple inventory)

| ID | Назва | Категорія | Залишок | Мін. запас | Собівартість | Ціна продажу |
|----|-------|-----------|---------|------------|--------------|--------------|
| 101 | Круасан | Випічка | 15 | 8 | 22.00 | 55.00 |
| 102 | Круасан шоколадний | Випічка | 12 | 8 | 28.00 | 65.00 |
| 103 | Чізкейк | Десерти | 8 | 5 | 45.00 | 95.00 |
| 104 | Тірамісу | Десерти | 6 | 4 | 52.00 | 110.00 |
| 105 | Еклер | Десерти | 10 | 6 | 18.00 | 45.00 |
| 106 | Маффін чорниця | Випічка | 8 | 6 | 15.00 | 45.00 |
| 107 | Печиво вівсяне (3шт) | Випічка | 20 | 10 | 12.00 | 35.00 |
| 108 | Сендвіч курка | Їжа | 6 | 4 | 55.00 | 120.00 |
| 109 | Сендвіч лосось | Їжа | 4 | 3 | 72.00 | 145.00 |
| 110 | Салат Цезар | Їжа | 5 | 3 | 58.00 | 135.00 |

### 1.3 Рецепти напоїв

#### Еспресо
| Розмір | Кава (g) | Стакан | Собівартість | Ціна |
|--------|----------|--------|--------------|------|
| Стандарт | 18 | — | 15.30 | 45.00 |
| Допіо | 36 | — | 30.60 | 65.00 |

#### Американо
| Розмір | Кава (g) | Вода (ml) | Стакан | Собівартість | Ціна |
|--------|----------|-----------|--------|--------------|------|
| S 250мл | 18 | 200 | 250мл | 17.80 | 55.00 |
| M 350мл | 18 | 300 | 350мл | 18.30 | 65.00 |
| L 450мл | 24 | 400 | 450мл | 24.20 | 75.00 |

#### Капучіно
| Розмір | Кава (g) | Молоко (ml) | Стакан | Собівартість | Ціна |
|--------|----------|-------------|--------|--------------|------|
| S 250мл | 18 | 180 | 250мл | 23.56 | 65.00 |
| M 350мл | 18 | 280 | 350мл | 24.76 | 75.00 |
| L 450мл | 24 | 380 | 450мл | 35.06 | 85.00 |

#### Латте
| Розмір | Кава (g) | Молоко (ml) | Стакан | Собівартість | Ціна |
|--------|----------|-------------|--------|--------------|------|
| S 300мл | 18 | 250 | 350мл | 26.30 | 70.00 |
| M 400мл | 18 | 350 | 450мл | 29.50 | 85.00 |
| L 500мл | 24 | 450 | 450мл | 38.10 | 95.00 |

#### Флет Вайт
| Розмір | Кава (g) | Молоко (ml) | Стакан | Собівартість | Ціна |
|--------|----------|-------------|--------|--------------|------|
| Стандарт | 36 | 150 | 250мл | 35.60 | 75.00 |

#### Раф
| Розмір | Кава (g) | Вершки (ml) | Сироп (ml) | Стакан | Собівартість | Ціна |
|--------|----------|-------------|------------|--------|--------------|------|
| S 300мл | 18 | 200 | 20 | 350мл | 42.70 | 85.00 |
| M 400мл | 18 | 300 | 30 | 450мл | 57.10 | 100.00 |

#### Айс Латте
| Розмір | Кава (g) | Молоко (ml) | Лід (g) | Стакан | Собівартість | Ціна |
|--------|----------|-------------|---------|--------|--------------|------|
| M 400мл | 36 | 250 | 100 | 450мл | 41.10 | 75.00 |
| L 500мл | 36 | 350 | 150 | 450мл | 44.30 | 90.00 |

#### Мокко
| Розмір | Кава (g) | Молоко (ml) | Шоколад (g) | Стакан | Собівартість | Ціна |
|--------|----------|-------------|-------------|--------|--------------|------|
| Стандарт | 18 | 200 | 20 | 350мл | 29.10 | 80.00 |

#### Матча Латте
| Розмір | Матча (g) | Молоко (ml) | Стакан | Собівартість | Ціна |
|--------|-----------|-------------|--------|--------------|------|
| S 300мл | 3 | 250 | 350мл | 18.50 | 85.00 |
| M 400мл | 4 | 350 | 450мл | 24.70 | 100.00 |

#### Чай
| Напій | Кількість (g) | Вода (ml) | Стакан | Собівартість | Ціна |
|-------|---------------|-----------|--------|--------------|------|
| Чорний S | 3 | 300 | 350мл | 4.35 | 40.00 |
| Чорний L | 5 | 500 | 450мл | 5.75 | 55.00 |
| Зелений S | 3 | 300 | 350мл | 4.65 | 45.00 |
| Зелений L | 5 | 500 | 450мл | 6.25 | 60.00 |

---

## Фаза 2: POS інтеграція

### 2.1 Flow продажу

```
1. Касир вибирає продукт → 2. Вибір розміру/модифікаторів
         ↓
3. Додавання в кошик → 4. Оплата
         ↓
5. Створення OrderItem → 6. Списання інгредієнтів
         ↓
7. Оновлення залишків → 8. Перевірка low stock → 9. Сповіщення
```

### 2.2 Списання інгредієнтів

При продажу Латте M (400мл):
```typescript
deductIngredients({
  orderId: "ORD-001",
  productId: "latte",
  sizeId: "m",
  quantity: 1,
  deductions: [
    { ingredientId: 4, amount: 18, unit: "g" },    // Кава
    { ingredientId: 1, amount: 350, unit: "ml" },  // Молоко
    { ingredientId: 16, amount: 1, unit: "pcs" },  // Стакан 350мл
    { ingredientId: 18, amount: 1, unit: "pcs" },  // Кришка
  ]
});
```

---

## Фаза 3: Система поставок

### 3.1 Структура поставки

```typescript
interface Supply {
  id: string;
  supplierId: string;
  supplierName: string;
  status: 'draft' | 'ordered' | 'shipped' | 'received' | 'cancelled';
  orderDate?: string;
  expectedDate?: string;
  receivedDate?: string;
  items: SupplyItem[];
  totalCost: number;
  notes?: string;
}

interface SupplyItem {
  ingredientId: number;
  ingredientName: string;
  orderedQuantity: number;
  receivedQuantity?: number;
  unitCost: number;
  totalCost: number;
}
```

### 3.2 Flow поставки

```
1. Створення заявки (draft)
   ↓
2. Відправка постачальнику (ordered)
   ↓
3. Товар в дорозі (shipped)
   ↓
4. Отримання товару (received)
   ↓
5. Оновлення залишків + транзакція
```

---

## Фаза 4: Система сповіщень

### 4.1 Типи сповіщень

| Тип | Пріоритет | Опис | Приклад |
|-----|-----------|------|---------|
| `low_stock` | high | Закінчується інгредієнт | "Молоко: залишилось 2л (мін: 3л)" |
| `out_of_stock` | critical | Інгредієнт закінчився | "Сироп карамель: 0 мл" |
| `supply_received` | normal | Поставка отримана | "Поставка #45 від Молочар отримана" |
| `supply_expected` | normal | Очікується поставка | "Завтра поставка від CoffeePro" |
| `shift_action` | low | Дія на зміні | "Касир Анна: відкриття каси" |
| `order_cancelled` | normal | Скасоване замовлення | "Замовлення #123 скасовано" |
| `high_sales` | info | Високі продажі | "Латте: 50+ продажів сьогодні" |
| `system` | varies | Системні | "Резервне копіювання завершено" |

### 4.2 Архітектура сповіщень

```typescript
interface Notification {
  id: string;
  type: NotificationType;
  priority: 'critical' | 'high' | 'normal' | 'low' | 'info';
  title: string;
  message: string;
  data?: Record<string, unknown>;
  read: boolean;
  actionUrl?: string;
  createdAt: string;
  expiresAt?: string;
}
```

---

## Фаза 5: Звіти

### 5.1 Головна сторінка звітів

**Секції:**
1. **Зведення за сьогодні** - виручка, кількість замовлень, середній чек
2. **Продажі по годинах** - графік
3. **Топ продуктів** - найпопулярніші позиції
4. **Дії на зміні** - журнал операцій
5. **Статус складу** - критичні позиції

### 5.2 Журнал дій (Shift Actions)

| Час | Дія | Касир | Деталі |
|-----|-----|-------|--------|
| 09:00 | Відкриття зміни | Анна К. | Каса: ₴2000 |
| 09:15 | Продаж | Анна К. | Замовлення #101: ₴185 |
| 10:30 | Поставка | Анна К. | Молочар: молоко 10л |
| 12:00 | Списання | Анна К. | Круасан x2 (прострочено) |
| 14:00 | Зміна касира | Олексій М. | — |
| 18:00 | Закриття зміни | Олексій М. | Виручка: ₴12,450 |

---

## Черговість реалізації

### Етап 1: Дані (поточний)
- [x] Типи Ingredient, Recipe
- [ ] Seed data для інгредієнтів
- [ ] Seed data для рецептів
- [ ] Seed data для готової продукції

### Етап 2: POS інтеграція
- [ ] Зв'язок Product → Recipe
- [ ] Списання при продажу
- [ ] Оновлення залишків в реальному часі

### Етап 3: Поставки
- [ ] CRUD для поставок
- [ ] UI сторінка поставок
- [ ] Прийом товару + транзакції

### Етап 4: Сповіщення
- [ ] Store для сповіщень
- [ ] UI компонент NotificationCenter
- [ ] Тригери для low stock
- [ ] Bell icon в header

### Етап 5: Звіти
- [ ] Переробити сторінку /admin/reports
- [ ] Dashboard з метриками
- [ ] Журнал дій
- [ ] Фільтри по датах

---

## Технічний стек

- **State**: Zustand (вже використовується)
- **Data fetching**: React Query (вже використовується)
- **Real-time**: WebSocket / SSE (опціонально)
- **Charts**: Recharts (для графіків)
